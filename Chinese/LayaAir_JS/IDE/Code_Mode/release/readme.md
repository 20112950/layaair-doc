# 项目发布详解

![1](img/1.png)  

（图1）

项目菜单的发布功能是非常核心的功能，通常是用于游戏的JS合并、JS压缩与混淆、图片压缩、版本管理、游戏不同平台的适配等。在项目完成开发，或阶段性完成开发，准备提交到生产环境中进行测试时，通常会用到项目发布的功能。

在项目菜单里，打开项目发布功能的界面如图1所示，下面将逐一进行介绍：

### 1、发布平台

发布平台中有三种选择选项，分别为web/Native平台，微信小游戏平台、QQ玩一玩平台。如图2所示。

![2](img/2.png) 

（图2）  

`web/Native` 是指发布为HTML5版本，运行于浏览器环境或者是LayaNative的APP环境中。

`微信小游戏` 是指发布为微信小游戏版本，运行于微信小程序的小游戏平台中。

`QQ玩一玩`是指发布为玩一玩游戏版本，运行于手机QQ的玩一玩游戏平台中。

### 2、源根目录

源根目录是指发布的版本文件**来源目录**，AS3语言的项目位于`项目根目录\bin\h5`，这个目录不要搞错。

### 3、发布目录

发布目录是指要发布到的**目标目录**，可以是项目所在的目标，也可以是与项目无关的目录。比如，指向到微信小游戏创建的项目目录。

**特别提示**：

> 1、发布微信小游戏时，如果项目内没有对适配程序进行初始化，直接发布过去，在微信开发者工具内会报错。
>
> 2、微信小游戏和QQ玩一玩默认不支持xml，如果游戏项目中使用了xml，必须在玩一玩或小游戏项目内引用xml解析库（domparserinone.js），否则发布过去，直接运行也会报错。
>
> 3、更多微信小游戏和QQ玩一玩相关的发布注意事项和工作流程等教程，可以查看更详细的相关文档。

### 4、排除文件

用于排除源根目录下的，一些目录或文件，有多个的话，用分号`;`隔开。

### 5、是否合并index.html内的所有js文件

勾选后，会分析index.html内的js，将所有index.html内的JS合并为一个JS。

这个选项虽然是可选项，但是发布微信小游戏的话，基于微信小游戏的特殊机制，该项成为必选项。

### 6、是否压缩PNG、JPG、

勾选压缩选项后，才会按后缀名进行压缩。在压缩PNG或JPG资源时，可以通过参数控制质量，发布时的默认值，如果开发者觉得效果未达到目标，可以自行调整尝试。

### 7、是否压缩JSON

是否压缩JSON选项时，并不仅仅是JSON后缀的文件，默认列出了一些常用的可能需要压缩的文件格式（json、atlas、ls、lh、lmat、lav），如果符合这些范围的后缀就会开始压缩。如果有不需要压缩的后缀格式，直接去掉后缀就可以。

### 8、是否混淆压缩JS

勾选这个模式的时候，会对JS进行压缩和混淆。

### 9、是否启用版本管理

勾选这个选项后，启用版本管理。

启用版本管理之后，将会生成带hash的文件名，并生成一个version.json的文件名映射文件，在项目中可以通过使用ResourceVersion类进行版本控制，使用版本控制之后就会在加载时自动去加载带hash的文件名。

这样做的好处，就是避免一些缓存比较严重，而且很难清理的运行环境下。用于版本升级更新。

更详细的版本管理介绍，请查看相关文章【版本管理功能介绍】



